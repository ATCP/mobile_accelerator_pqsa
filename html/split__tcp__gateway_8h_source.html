<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Mobile Accelerator: split_tcp_gateway.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mobile Accelerator
   &#160;<span id="projectnumber">1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">split_tcp_gateway.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="split__tcp__gateway_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;pcap/pcap.h&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;deque&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="es__TIMER_8h.html">es_TIMER.h</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;sys/ioctl.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;net/if.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">using namespace </span>std;
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="split__tcp__gateway_8h.html#a0fa354abb723f3d7b1cdfea68545bb45">00027</a> <span class="preprocessor">#define PKT_SIZE 1515</span>
<a name="l00028"></a><a class="code" href="split__tcp__gateway_8h.html#a36599cac4836e95d683567e1c087cef7">00028</a> <span class="preprocessor"></span><span class="preprocessor">#define CIRCULAR_BUF_SIZE 2048</span>
<a name="l00029"></a><a class="code" href="split__tcp__gateway_8h.html#a974ca4dba153d903f5ece2cd259aea20">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define CIRCULAR_QUEUE_SIZE 1024</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a><a class="code" href="split__tcp__gateway_8h.html#a958666a0119df06831dcd7af156de02a">00031</a> <span class="preprocessor">#define END_TO_END_DELAY 250000000</span>
<a name="l00032"></a><a class="code" href="split__tcp__gateway_8h.html#a76c9325f9830b269066295e34a168433">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define IPTOSBUFFERS 12</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a><a class="code" href="split__tcp__gateway_8h.html#a7cfe89fde32f34356459073e235b639c">00034</a> <span class="preprocessor">#define MAX_CONN_STATES 65536</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a><a class="code" href="split__tcp__gateway_8h.html#ae35eecc21dd9fad30b97b7ddaf9bf8ca">00036</a> <span class="preprocessor">#define LOCAL_WINDOW 65535</span>
<a name="l00037"></a><a class="code" href="split__tcp__gateway_8h.html#a3b4d8a5e259fa47a909adefcda3bfb80">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define RECEIVE 0</span>
<a name="l00038"></a><a class="code" href="split__tcp__gateway_8h.html#abc9603445bf79a3793831ee1d0ea8890">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define SEND 1</span>
<a name="l00039"></a><a class="code" href="split__tcp__gateway_8h.html#a0ff29830fde482fdf175988774b78edb">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define MTU 1500</span>
<a name="l00040"></a><a class="code" href="split__tcp__gateway_8h.html#af0ffb83c695e1b56dbc3e93b3ea5afb0">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define WIN_SCALE 5   // capacity need 1 or 0</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>
<a name="l00042"></a>00042 <span class="comment">//#define RTT_LIMIT 200000</span>
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="split__tcp__gateway_8h.html#a20694499504d1ffc7f27e30ff0062875">00044</a> <span class="preprocessor">#define MAX_RTO 500000</span>
<a name="l00045"></a><a class="code" href="split__tcp__gateway_8h.html#adc8c929a0f45a709d51531fe231be076">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_RTO_IETF 1000000</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="split__tcp__gateway_8h.html#a09c42fa58ae18c1ca7f0150a782eb2f8">00047</a> <span class="preprocessor">#define NUM_DUP_ACK 3</span>
<a name="l00048"></a><a class="code" href="split__tcp__gateway_8h.html#ac449ac04576e7ad912f45dfd0a8babff">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define STD_RTT</span>
<a name="l00049"></a><a class="code" href="split__tcp__gateway_8h.html#a95f3a3e19eeb74df0f57af7a1859f0c6">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define LINUX_RTT</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a><a class="code" href="split__tcp__gateway_8h.html#a144c6d9759dad2afe4c5f76ee747f0c7">00051</a> <span class="preprocessor">#define TIME_TO_LIVE 20000000 //us</span>
<a name="l00052"></a><a class="code" href="split__tcp__gateway_8h.html#a0775dcac306a126089e592376e574085">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define DYNAMIC_RATE_FIT</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="comment">//#define LOG_STAT</span>
<a name="l00055"></a><a class="code" href="split__tcp__gateway_8h.html#a95d55ebfa2f2f1bd14867ad6a6cc9bfb">00055</a> <span class="preprocessor">#define RESOLUTION 1000000</span>
<a name="l00056"></a><a class="code" href="split__tcp__gateway_8h.html#ae893441b4ffaf5c2f259b40e0a58acaa">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define SLIDING_WIN_SIZE 500</span>
<a name="l00057"></a><a class="code" href="split__tcp__gateway_8h.html#aa6336f73a74f4106e550e1079b244ecf">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define SND_WIN_SIZE 32</span>
<a name="l00058"></a><a class="code" href="split__tcp__gateway_8h.html#ac6738871bcfd2931827f06806b16dafb">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define NUM_SACK_BLOCK 1</span>
<a name="l00059"></a><a class="code" href="split__tcp__gateway_8h.html#ac01212c93070dead59f3e50bf46dd24f">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define COMPLETE_SPLITTING_TCP</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span>
<a name="l00061"></a>00061 <span class="comment">/* multi-user extension */</span>
<a name="l00062"></a><a class="code" href="split__tcp__gateway_8h.html#a72a5443d670bf99c8273f32847315e23">00062</a> <span class="preprocessor">#define TOTAL_NUM_CONN 550</span>
<a name="l00063"></a><a class="code" href="split__tcp__gateway_8h.html#abbff139c686c6463de44909680c4fb30">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define CLIENT_SACK_SIZE 5</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span>
<a name="l00065"></a>00065 <span class="comment">//#define DEBUG</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* time interval estimation */</span>
<a name="l00068"></a><a class="code" href="split__tcp__gateway_8h.html#a0ac49a21f53ff9baab317d92b33a6bc5">00068</a> <span class="preprocessor">#define SLIDE_TIME_INTERVAL 1200000</span>
<a name="l00069"></a><a class="code" href="split__tcp__gateway_8h.html#a7a21532fb6200d0eae2ff82580a5a264">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define FIX_TIME_INTERVAL_EST</span>
<a name="l00070"></a><a class="code" href="split__tcp__gateway_8h.html#a9f3346a136b3988e69e88bb9c5d6dfa4">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define SLIDE_TIME_DELTA 5000</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="split__tcp__gateway_8h.html#a050c65e107f0c828f856a231f4b4e788">00072</a> <span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="split__tcp__gateway_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>;
<a name="l00073"></a><a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">00073</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a>;
<a name="l00074"></a><a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">00074</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>;
<a name="l00075"></a><a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">00075</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a>;
<a name="l00076"></a><a class="code" href="split__tcp__gateway_8h.html#a44e044c742563fdce87d0e06894c8cad">00076</a> <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="split__tcp__gateway_8h.html#a44e044c742563fdce87d0e06894c8cad">__int64</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="split__tcp__gateway_8h.html#aa93f0eb578d23995850d61f7d61c55c1">00078</a> <span class="preprocessor">#define FALSE 0</span>
<a name="l00079"></a><a class="code" href="split__tcp__gateway_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define TRUE 1</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span>
<a name="l00081"></a><a class="code" href="split__tcp__gateway_8h.html#a23264d91b6bee2670c94e0cd9e1636f6">00081</a> <span class="preprocessor">#define MY_SEQ_LT(a, b)  ((int)((a) - (b)) &lt; 0)</span>
<a name="l00082"></a><a class="code" href="split__tcp__gateway_8h.html#ac380ce24661f0d0aefa56c19088c4c72">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define MY_SEQ_LEQ(a, b)  ((int)((a) - (b)) &lt;= 0)</span>
<a name="l00083"></a><a class="code" href="split__tcp__gateway_8h.html#a81e92f53214d326985a905c73ac690d8">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define MY_SEQ_GT(a, b)  ((int)((a) - (b)) &gt; 0)</span>
<a name="l00084"></a><a class="code" href="split__tcp__gateway_8h.html#a97afee085bdb358ccb8c0bbed06aa83e">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define MY_SEQ_GEQ(a, b)  ((int)((a) - (b)) &gt;= 0)</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a><a class="code" href="split__tcp__gateway_8h.html#a9e01d8dbd8a4146d8666014ada0d098e">00086</a> <a class="code" href="classES__FlashTimer.html">ES_FlashTimer</a> <a class="code" href="split__tcp__gateway_8h.html#a9e01d8dbd8a4146d8666014ada0d098e">timer</a>;
<a name="l00087"></a><a class="code" href="split__tcp__gateway_8h.html#a2aab82b6722ab71d9d958a32484632e7">00087</a> FILE* <a class="code" href="split__tcp__gateway_8h.html#a2aab82b6722ab71d9d958a32484632e7">test_file</a>;
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="split__tcp__gateway_8h.html#a337911124b978235a93a107460c34ed0">00089</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#a337911124b978235a93a107460c34ed0">APP_PORT_NUM</a>;
<a name="l00090"></a><a class="code" href="split__tcp__gateway_8h.html#a99a7e9a59f9837d04f5d6ed16ede09fd">00090</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#a99a7e9a59f9837d04f5d6ed16ede09fd">APP_PORT_FORWARD</a>;
<a name="l00091"></a><a class="code" href="split__tcp__gateway_8h.html#a2c197a0339aee6bec6002ba26f444705">00091</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#a2c197a0339aee6bec6002ba26f444705">MAX_SEND_RATE</a>;
<a name="l00092"></a><a class="code" href="split__tcp__gateway_8h.html#a3316734b25184173620af0089e6a4900">00092</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#a3316734b25184173620af0089e6a4900">MIN_SEND_RATE</a>;
<a name="l00093"></a><a class="code" href="split__tcp__gateway_8h.html#accf6f5ac2ee1b2e994b86b4ce7045359">00093</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#accf6f5ac2ee1b2e994b86b4ce7045359">INITIAL_RATE</a>;
<a name="l00094"></a><a class="code" href="split__tcp__gateway_8h.html#aebbd1b7ecd5a7c06378038963929ce4e">00094</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#aebbd1b7ecd5a7c06378038963929ce4e">SND_BEYOND_WIN</a>;
<a name="l00095"></a><a class="code" href="split__tcp__gateway_8h.html#ab32a70721d748cd552869c1bd141ddb9">00095</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#ab32a70721d748cd552869c1bd141ddb9">NUM_PKT_BEYOND_WIN</a>;
<a name="l00096"></a><a class="code" href="split__tcp__gateway_8h.html#a138f413a4a95f88fbfe1f0724765a11e">00096</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#a138f413a4a95f88fbfe1f0724765a11e">RTT_LIMIT</a>;
<a name="l00097"></a><a class="code" href="split__tcp__gateway_8h.html#aa4054f07d498f5ffe165643d0dc2315b">00097</a> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="split__tcp__gateway_8h.html#aa4054f07d498f5ffe165643d0dc2315b">BDP</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">00100</a> <span class="keyword">enum</span> <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">DIRECTION</a>
<a name="l00101"></a>00101 {
<a name="l00102"></a><a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0a0df224cab9714b02d0718697fbce48a3">00102</a>         <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0a0df224cab9714b02d0718697fbce48a3">SERVER_TO_CLIENT</a>,
<a name="l00103"></a><a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0ae4561e948350e841223c3dc44738f476">00103</a>         <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0ae4561e948350e841223c3dc44738f476">CLIENT_TO_SERVER</a>,
<a name="l00104"></a>00104 };
<a name="l00105"></a><a class="code" href="structseg__info.html">00105</a> <span class="keyword">struct </span><a class="code" href="structseg__info.html">seg_info</a>
<a name="l00106"></a>00106 {
<a name="l00107"></a><a class="code" href="structseg__info.html#a1b9983539358d0f82b663b5fd818df3e">00107</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structseg__info.html#a1b9983539358d0f82b663b5fd818df3e">forward_time</a>;
<a name="l00108"></a><a class="code" href="structseg__info.html#a341cccbcaba36998f1e5c1b761b1d1e6">00108</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structseg__info.html#a341cccbcaba36998f1e5c1b761b1d1e6">seq_num</a>;
<a name="l00109"></a><a class="code" href="structseg__info.html#a246933b1ef67d54e9b3da1b9806b0c5e">00109</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structseg__info.html#a246933b1ef67d54e9b3da1b9806b0c5e">data_len</a>;
<a name="l00110"></a>00110 };
<a name="l00111"></a><a class="code" href="structip__address.html">00111</a> <span class="keyword">struct </span><a class="code" href="structip__address.html">ip_address</a>
<a name="l00112"></a>00112 {
<a name="l00113"></a><a class="code" href="structip__address.html#a9829ac0f8b39812bb17cddc339289799">00113</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structip__address.html#a9829ac0f8b39812bb17cddc339289799">byte1</a>;
<a name="l00114"></a><a class="code" href="structip__address.html#a15fca759942b133e4ded44dd6893134e">00114</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structip__address.html#a15fca759942b133e4ded44dd6893134e">byte2</a>;
<a name="l00115"></a><a class="code" href="structip__address.html#ab66ba09a8078bd76b2d94d3c473510c0">00115</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structip__address.html#ab66ba09a8078bd76b2d94d3c473510c0">byte3</a>;
<a name="l00116"></a><a class="code" href="structip__address.html#af9371530b5b91215d12d5027a3caa1a1">00116</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structip__address.html#af9371530b5b91215d12d5027a3caa1a1">byte4</a>;
<a name="l00117"></a>00117 };
<a name="l00118"></a><a class="code" href="structpsd__header.html">00118</a> <span class="keyword">struct </span><a class="code" href="structpsd__header.html">psd_header</a>
<a name="l00119"></a>00119 {
<a name="l00120"></a><a class="code" href="structpsd__header.html#af934fedec53c4ea727c2f5f341f50595">00120</a>         <a class="code" href="structip__address.html">ip_address</a> <a class="code" href="structpsd__header.html#af934fedec53c4ea727c2f5f341f50595">saddr</a>;
<a name="l00121"></a><a class="code" href="structpsd__header.html#ac41be6ffba22a86307644444a818f419">00121</a>         <a class="code" href="structip__address.html">ip_address</a> <a class="code" href="structpsd__header.html#ac41be6ffba22a86307644444a818f419">daddr</a>;
<a name="l00122"></a><a class="code" href="structpsd__header.html#a8790d2f82a9b2031d8144f2627c4f4c9">00122</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structpsd__header.html#a8790d2f82a9b2031d8144f2627c4f4c9">mbz</a>;
<a name="l00123"></a><a class="code" href="structpsd__header.html#ac3af2de6f30534e1cf4b3d8985c12a83">00123</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structpsd__header.html#ac3af2de6f30534e1cf4b3d8985c12a83">ptoto</a>;
<a name="l00124"></a><a class="code" href="structpsd__header.html#a13e8c4030f69d21c7f78ab54e75ef43c">00124</a>         u_short <a class="code" href="structpsd__header.html#a13e8c4030f69d21c7f78ab54e75ef43c">tcp_len</a>;
<a name="l00125"></a>00125 };
<a name="l00126"></a><a class="code" href="structmac__header.html">00126</a> <span class="keyword">struct </span><a class="code" href="structmac__header.html">mac_header</a>
<a name="l00127"></a>00127 {
<a name="l00128"></a><a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">00128</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> mac_src[6];              <span class="comment">// mac source address</span>
<a name="l00129"></a><a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">00129</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> mac_dst[6];              <span class="comment">// mac destination address</span>
<a name="l00130"></a><a class="code" href="structmac__header.html#a0c81aee566e934480ffc598deaf9787b">00130</a>         u_short <a class="code" href="structmac__header.html#a0c81aee566e934480ffc598deaf9787b">opt</a>;
<a name="l00131"></a>00131 };
<a name="l00132"></a><a class="code" href="structip__header.html">00132</a> <span class="keyword">struct </span><a class="code" href="structip__header.html">ip_header</a>
<a name="l00133"></a>00133 {
<a name="l00134"></a><a class="code" href="structip__header.html#a5eb344fea96865ef5757d712a23274b4">00134</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structip__header.html#a5eb344fea96865ef5757d712a23274b4">ver_ihl</a>;                <span class="comment">// Version (4 bits) + Internet header length (4 bits)</span>
<a name="l00135"></a><a class="code" href="structip__header.html#a14c3d2a74ce954f35be8c4353122c188">00135</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structip__header.html#a14c3d2a74ce954f35be8c4353122c188">tos</a>;                    <span class="comment">// Type of service</span>
<a name="l00136"></a><a class="code" href="structip__header.html#a551538f84a5cdac3e0accc9551c22793">00136</a>         u_short <a class="code" href="structip__header.html#a551538f84a5cdac3e0accc9551c22793">tlen</a>;                   <span class="comment">// Total length</span>
<a name="l00137"></a><a class="code" href="structip__header.html#a076993a245f166daecc00e5526d1e3a1">00137</a>         u_short <a class="code" href="structip__header.html#a076993a245f166daecc00e5526d1e3a1">identification</a>; <span class="comment">// Identification</span>
<a name="l00138"></a><a class="code" href="structip__header.html#ac55a50eeceb2167dc1e13b12b4644920">00138</a>         u_short <a class="code" href="structip__header.html#ac55a50eeceb2167dc1e13b12b4644920">flags_fo</a>;               <span class="comment">// Flags (3 bits) + Fragment offset (13 bits)</span>
<a name="l00139"></a><a class="code" href="structip__header.html#aefda609a054b2e0442ec676317ba5650">00139</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structip__header.html#aefda609a054b2e0442ec676317ba5650">ttl</a>;                    <span class="comment">// Time to live</span>
<a name="l00140"></a><a class="code" href="structip__header.html#a6f82f74102352fb10e179da3c7faffde">00140</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a>  <a class="code" href="structip__header.html#a6f82f74102352fb10e179da3c7faffde">proto</a>;                  <span class="comment">// Protocol</span>
<a name="l00141"></a><a class="code" href="structip__header.html#a5c25739369b6383e236ea81e840eabd7">00141</a>         u_short <a class="code" href="structip__header.html#a5c25739369b6383e236ea81e840eabd7">crc</a>;                    <span class="comment">// Header checksum</span>
<a name="l00142"></a><a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">00142</a>         <a class="code" href="structip__address.html">ip_address</a>      <a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">saddr</a>;          <span class="comment">// Source address</span>
<a name="l00143"></a><a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">00143</a>         <a class="code" href="structip__address.html">ip_address</a>      <a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">daddr</a>;          <span class="comment">// Destination address</span>
<a name="l00144"></a>00144 };
<a name="l00145"></a><a class="code" href="structtcp__header.html">00145</a> <span class="keyword">struct </span><a class="code" href="structtcp__header.html">tcp_header</a>
<a name="l00146"></a>00146 {
<a name="l00147"></a><a class="code" href="structtcp__header.html#a36d1e56a05521e48f27b290522734462">00147</a>         u_short <a class="code" href="structtcp__header.html#a36d1e56a05521e48f27b290522734462">sport</a>;               <span class="comment">//   Source   port</span>
<a name="l00148"></a><a class="code" href="structtcp__header.html#afad92b412e085a6237a98f7dcd0e1744">00148</a>         u_short <a class="code" href="structtcp__header.html#afad92b412e085a6237a98f7dcd0e1744">dport</a>;               <span class="comment">//   Destination   port</span>
<a name="l00149"></a><a class="code" href="structtcp__header.html#ae16e608ea5df1f84820820972c04f45e">00149</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structtcp__header.html#ae16e608ea5df1f84820820972c04f45e">seq_num</a>;               <span class="comment">//   sequence   number</span>
<a name="l00150"></a><a class="code" href="structtcp__header.html#ae452d7741f9b70695a797e2bb2608479">00150</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structtcp__header.html#ae452d7741f9b70695a797e2bb2608479">ack_num</a>;               <span class="comment">//   acknowledgement   number</span>
<a name="l00151"></a><a class="code" href="structtcp__header.html#a957cd867a63215d329c43eb6a1cfbd4a">00151</a>         u_short <a class="code" href="structtcp__header.html#a957cd867a63215d329c43eb6a1cfbd4a">hdr_len_resv_code</a>; <span class="comment">//   Datagram   length</span>
<a name="l00152"></a><a class="code" href="structtcp__header.html#a0b1bdce92d75ab4e05309ae6b666a6b2">00152</a>         u_short <a class="code" href="structtcp__header.html#a0b1bdce92d75ab4e05309ae6b666a6b2">window</a>;                  <span class="comment">//   window</span>
<a name="l00153"></a><a class="code" href="structtcp__header.html#ac0b5df1d697bf90d8286b889609daca0">00153</a>         u_short <a class="code" href="structtcp__header.html#ac0b5df1d697bf90d8286b889609daca0">crc</a>;                     <span class="comment">//   Checksum</span>
<a name="l00154"></a><a class="code" href="structtcp__header.html#a8ca2bf27396ec84f7a08c4c3ac41cba1">00154</a>         u_short <a class="code" href="structtcp__header.html#a8ca2bf27396ec84f7a08c4c3ac41cba1">urg_pointer</a>;     <span class="comment">//   urgent   pointer</span>
<a name="l00155"></a>00155 };
<a name="l00156"></a><a class="code" href="structtcp__sack__block.html">00156</a> <span class="keyword">struct </span><a class="code" href="structtcp__sack__block.html">tcp_sack_block</a>
<a name="l00157"></a>00157 {
<a name="l00158"></a><a class="code" href="structtcp__sack__block.html#aa7f8edc8beafeadf7ed11f8ca7f9edfd">00158</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structtcp__sack__block.html#aa7f8edc8beafeadf7ed11f8ca7f9edfd">left_edge_block</a>;
<a name="l00159"></a><a class="code" href="structtcp__sack__block.html#a4417284e2f5d213938cadbe73aee3da0">00159</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structtcp__sack__block.html#a4417284e2f5d213938cadbe73aee3da0">right_edge_block</a>;
<a name="l00160"></a>00160 };
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="structtcp__sack.html">00162</a> <span class="keyword">struct </span><a class="code" href="structtcp__sack.html">tcp_sack</a>
<a name="l00163"></a>00163 {
<a name="l00164"></a><a class="code" href="structtcp__sack.html#a5c3aee8a5a49aedbf2748f6f59dd91e7">00164</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structtcp__sack.html#a5c3aee8a5a49aedbf2748f6f59dd91e7">pad_1</a>;
<a name="l00165"></a><a class="code" href="structtcp__sack.html#ada362f6194b8cdf78587682882a89843">00165</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structtcp__sack.html#ada362f6194b8cdf78587682882a89843">pad_2</a>;
<a name="l00166"></a><a class="code" href="structtcp__sack.html#acdca33b1e8c3971e1290782cc5595c0f">00166</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structtcp__sack.html#acdca33b1e8c3971e1290782cc5595c0f">kind</a>;
<a name="l00167"></a><a class="code" href="structtcp__sack.html#a85395de82d87dd9a987320d5d27c48fb">00167</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> <a class="code" href="structtcp__sack.html#a85395de82d87dd9a987320d5d27c48fb">length</a>;
<a name="l00168"></a><a class="code" href="structtcp__sack.html#ad10a084fa496be3cad68023841f6ebe4">00168</a>         <a class="code" href="structtcp__sack__block.html">tcp_sack_block</a> sack_block[<a class="code" href="split__tcp__gateway_8h.html#abbff139c686c6463de44909680c4fb30">CLIENT_SACK_SIZE</a>];
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 };
<a name="l00171"></a><a class="code" href="structsack__header.html">00171</a> <span class="keyword">struct </span><a class="code" href="structsack__header.html">sack_header</a>
<a name="l00172"></a>00172 {
<a name="l00173"></a><a class="code" href="structsack__header.html#a30cb8f796465a2a49b0d9d06b5f78cfd">00173</a>         <a class="code" href="structtcp__sack__block.html">tcp_sack_block</a> sack_list[<a class="code" href="split__tcp__gateway_8h.html#abbff139c686c6463de44909680c4fb30">CLIENT_SACK_SIZE</a>];
<a name="l00174"></a><a class="code" href="structsack__header.html#a3efcdaf0c8a71592d6ffdf0bdf9ec50e">00174</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structsack__header.html#a3efcdaf0c8a71592d6ffdf0bdf9ec50e">_size</a>;
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="structsack__header.html#a1f8460cf2e19a0f1a9a93491a58dd218">00176</a>         <a class="code" href="structsack__header.html">sack_header</a>()
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178                 <span class="keywordflow">for</span> (u_short i = 0; i &lt; <a class="code" href="split__tcp__gateway_8h.html#abbff139c686c6463de44909680c4fb30">CLIENT_SACK_SIZE</a>; i ++)
<a name="l00179"></a>00179                 {
<a name="l00180"></a>00180                         sack_list[i].left_edge_block = 0;
<a name="l00181"></a>00181                         sack_list[i].right_edge_block= 0;
<a name="l00182"></a>00182                 }
<a name="l00183"></a>00183                 _size = 0;
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="structsack__header.html#a446f1cc8c6000af99805120924ece9e4">00186</a>         <span class="keywordtype">void</span> <span class="keyword">inline</span> flush()
<a name="l00187"></a>00187         {
<a name="l00188"></a>00188                 <span class="keywordflow">for</span> (u_short i = 0; i &lt; <a class="code" href="split__tcp__gateway_8h.html#abbff139c686c6463de44909680c4fb30">CLIENT_SACK_SIZE</a>; i ++)
<a name="l00189"></a>00189                 {
<a name="l00190"></a>00190                         sack_list[i].left_edge_block = 0;
<a name="l00191"></a>00191                         sack_list[i].right_edge_block = 0;
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193                 _size = 0;
<a name="l00194"></a>00194         }
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="structsack__header.html#a403bc1e0cc695ee109329568cfb3c777">00196</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> size()
<a name="l00197"></a>00197         {
<a name="l00198"></a>00198                 <span class="keywordflow">return</span> _size;
<a name="l00199"></a>00199         }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 };
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="structudp__header.html">00203</a> <span class="keyword">struct </span><a class="code" href="structudp__header.html">udp_header</a>
<a name="l00204"></a>00204 {
<a name="l00205"></a><a class="code" href="structudp__header.html#a71c74d82739ecf97039e4e29b574f48c">00205</a>         u_short <a class="code" href="structudp__header.html#a71c74d82739ecf97039e4e29b574f48c">sport</a>;                  <span class="comment">// Source port</span>
<a name="l00206"></a><a class="code" href="structudp__header.html#a2d40aa44f4eeb0f3a94989955cd598f6">00206</a>         u_short <a class="code" href="structudp__header.html#a2d40aa44f4eeb0f3a94989955cd598f6">dport</a>;                  <span class="comment">// Destination port</span>
<a name="l00207"></a><a class="code" href="structudp__header.html#aa0903b2195dab412d2f703a4d630ec7f">00207</a>         u_short <a class="code" href="structudp__header.html#aa0903b2195dab412d2f703a4d630ec7f">len</a>;                    <span class="comment">// Datagram length</span>
<a name="l00208"></a><a class="code" href="structudp__header.html#a6b117ab2c9d726d4d97defddc3fd1628">00208</a>         u_short <a class="code" href="structudp__header.html#a6b117ab2c9d726d4d97defddc3fd1628">crc</a>;                    <span class="comment">// Checksum</span>
<a name="l00209"></a>00209 };
<a name="l00210"></a><a class="code" href="structForwardPkt.html">00210</a> <span class="keyword">struct </span><a class="code" href="structForwardPkt.html">ForwardPkt</a>
<a name="l00211"></a>00211 {
<a name="l00212"></a><a class="code" href="structForwardPkt.html#a2e4d0793dc8830d17f823d5979f3261f">00212</a>         <span class="keywordtype">void</span> *<a class="code" href="structForwardPkt.html#a2e4d0793dc8830d17f823d5979f3261f">data</a>;
<a name="l00213"></a><a class="code" href="structForwardPkt.html#a302fdd75ab8fb5a475bc9a0c21db4fb7">00213</a>         <span class="keyword">struct </span>pcap_pkthdr header;
<a name="l00214"></a><a class="code" href="structForwardPkt.html#a3380962962774ae93f297052fafc7a30">00214</a>         <a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> pkt_data[<a class="code" href="split__tcp__gateway_8h.html#a0fa354abb723f3d7b1cdfea68545bb45">PKT_SIZE</a>];
<a name="l00215"></a><a class="code" href="structForwardPkt.html#a2147e5e35be17cd44b4d0118dbad71a8">00215</a>         <span class="keyword">struct </span><a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPkt.html#a2147e5e35be17cd44b4d0118dbad71a8">next</a>;
<a name="l00216"></a><a class="code" href="structForwardPkt.html#adae10cd3e262e7a0cd274f8879e72180">00216</a>         <span class="keyword">struct </span><a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPkt.html#adae10cd3e262e7a0cd274f8879e72180">prev</a>;
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="structForwardPkt.html#a20a35b6a4f29d9f73700ee47c0f64dcc">00218</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPkt.html#a20a35b6a4f29d9f73700ee47c0f64dcc">seq_num</a>;
<a name="l00219"></a><a class="code" href="structForwardPkt.html#a57122c5602fe8f2707c3720317f3ee80">00219</a>         u_short <a class="code" href="structForwardPkt.html#a57122c5602fe8f2707c3720317f3ee80">data_len</a>;
<a name="l00220"></a><a class="code" href="structForwardPkt.html#a247f9e1e1c5f32d28229ef8ed8d31fc0">00220</a>         u_short <a class="code" href="structForwardPkt.html#a247f9e1e1c5f32d28229ef8ed8d31fc0">ctr_flag</a>;
<a name="l00221"></a><a class="code" href="structForwardPkt.html#a295be2ad5f6a02351220a61f220b595f">00221</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structForwardPkt.html#a295be2ad5f6a02351220a61f220b595f">snd_time</a>;
<a name="l00222"></a><a class="code" href="structForwardPkt.html#a814c519962506223c23fda2c5c575182">00222</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structForwardPkt.html#a814c519962506223c23fda2c5c575182">rtx_time</a>;
<a name="l00223"></a><a class="code" href="structForwardPkt.html#ae0a13cdbb57b256782d476e052a04b13">00223</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPkt.html#ae0a13cdbb57b256782d476e052a04b13">num_dup</a>;
<a name="l00224"></a><a class="code" href="structForwardPkt.html#aafcfa8214f837f5ed5b2a645dd31e753">00224</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structForwardPkt.html#aafcfa8214f837f5ed5b2a645dd31e753">rcv_time</a>;
<a name="l00225"></a><a class="code" href="structForwardPkt.html#a303504046c1d8f05b2a026da7e5a45ec">00225</a>         u_short <a class="code" href="structForwardPkt.html#a303504046c1d8f05b2a026da7e5a45ec">sPort</a>, <a class="code" href="structForwardPkt.html#a0c0acc33271ed0353b6ed34093240b8c">dPort</a>;
<a name="l00226"></a><a class="code" href="structForwardPkt.html#a0bb409edcde42a14c214c5b7b721fa47">00226</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPkt.html#a0bb409edcde42a14c214c5b7b721fa47">index</a>;
<a name="l00227"></a><a class="code" href="structForwardPkt.html#ae6b9fe215eb8f4553dc674dddb18448b">00227</a>         <span class="keywordtype">bool</span> <a class="code" href="structForwardPkt.html#ae6b9fe215eb8f4553dc674dddb18448b">occupy</a>;
<a name="l00228"></a><a class="code" href="structForwardPkt.html#a3aa4c5efb82ffd5fc899806f697a6af7">00228</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPkt.html#a3aa4c5efb82ffd5fc899806f697a6af7">tcb</a>;
<a name="l00229"></a><a class="code" href="structForwardPkt.html#aca9b2ef2ea24cdc53901f38a6636c5aa">00229</a>         <span class="keywordtype">bool</span> <a class="code" href="structForwardPkt.html#aca9b2ef2ea24cdc53901f38a6636c5aa">is_rtx</a>;
<a name="l00230"></a>00230 
<a name="l00231"></a><a class="code" href="structForwardPkt.html#ad8118c5246082b33c4149f401781e5c9">00231</a>         <span class="keywordtype">void</span> <a class="code" href="structForwardPkt.html#ad8118c5246082b33c4149f401781e5c9">initPkt</a>()
<a name="l00232"></a>00232         {
<a name="l00233"></a>00233             <a class="code" href="structForwardPkt.html#a20a35b6a4f29d9f73700ee47c0f64dcc">seq_num</a> = 0;
<a name="l00234"></a>00234             <a class="code" href="structForwardPkt.html#a57122c5602fe8f2707c3720317f3ee80">data_len</a> = 0;
<a name="l00235"></a>00235             <a class="code" href="structForwardPkt.html#a247f9e1e1c5f32d28229ef8ed8d31fc0">ctr_flag</a> = 0;
<a name="l00236"></a>00236             <a class="code" href="structForwardPkt.html#a295be2ad5f6a02351220a61f220b595f">snd_time</a> = 0;
<a name="l00237"></a>00237             <a class="code" href="structForwardPkt.html#a814c519962506223c23fda2c5c575182">rtx_time</a> = 0;
<a name="l00238"></a>00238             <a class="code" href="structForwardPkt.html#aafcfa8214f837f5ed5b2a645dd31e753">rcv_time</a> = 0;
<a name="l00239"></a>00239             <a class="code" href="structForwardPkt.html#ae0a13cdbb57b256782d476e052a04b13">num_dup</a> = 0;
<a name="l00240"></a>00240             <a class="code" href="structForwardPkt.html#a303504046c1d8f05b2a026da7e5a45ec">sPort</a> = 0;
<a name="l00241"></a>00241             <a class="code" href="structForwardPkt.html#a0c0acc33271ed0353b6ed34093240b8c">dPort</a> = 0;
<a name="l00242"></a>00242             <a class="code" href="structForwardPkt.html#ae6b9fe215eb8f4553dc674dddb18448b">occupy</a> = <span class="keyword">false</span>;
<a name="l00243"></a>00243             <a class="code" href="structForwardPkt.html#aca9b2ef2ea24cdc53901f38a6636c5aa">is_rtx</a> = <span class="keyword">true</span>;
<a name="l00244"></a>00244             <a class="code" href="structForwardPkt.html#a0bb409edcde42a14c214c5b7b721fa47">index</a> = 0;
<a name="l00245"></a>00245         }
<a name="l00246"></a><a class="code" href="structForwardPkt.html#a1c697108f36471281da14897a4f887b6">00246</a>         <span class="keywordtype">void</span> <a class="code" href="structForwardPkt.html#a1c697108f36471281da14897a4f887b6">PktHandler</a>()
<a name="l00247"></a>00247         {
<a name="l00248"></a>00248                 <span class="keyword">struct </span>tm *ltime;
<a name="l00249"></a>00249                 <span class="keywordtype">char</span> timestr[16];
<a name="l00250"></a>00250                 time_t local_tv_sec;
<a name="l00251"></a>00251                 <a class="code" href="structmac__header.html">mac_header</a>* mh;
<a name="l00252"></a>00252                 <a class="code" href="structip__header.html">ip_header</a>* ih;
<a name="l00253"></a>00253                 <a class="code" href="structtcp__header.html">tcp_header</a>* th;
<a name="l00254"></a>00254                 <a class="code" href="structudp__header.html">udp_header</a>* uh;
<a name="l00255"></a>00255                 <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> ip_len;
<a name="l00256"></a>00256                 <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> tcp_len;
<a name="l00257"></a>00257                 <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> data_len;
<a name="l00258"></a>00258                 <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> seq_num, ack_num;
<a name="l00259"></a>00259                 u_short sport, dport;
<a name="l00260"></a>00260                 u_short ctr_flag;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262                 local_tv_sec = header.ts.tv_sec;
<a name="l00263"></a>00263                 ltime=localtime(&amp;local_tv_sec);
<a name="l00264"></a>00264                 strftime( timestr, <span class="keyword">sizeof</span>(timestr), <span class="stringliteral">&quot;%H:%M:%S&quot;</span>, ltime);
<a name="l00265"></a>00265                 printf(<span class="stringliteral">&quot;%s,%.6d len:%d &quot;</span>, timestr, header.ts.tv_usec, header.len);
<a name="l00266"></a>00266                 mh = (<a class="code" href="structmac__header.html">mac_header</a> *) pkt_data;
<a name="l00267"></a>00267                 printf(<span class="stringliteral">&quot;%d:%d:%d:%d:%d:%d -&gt; %d:%d:%d:%d:%d:%d &quot;</span>, mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[0],
<a name="l00268"></a>00268                 mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[1], mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[2], mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[3], mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[4],
<a name="l00269"></a>00269                 mh-&gt;<a class="code" href="structmac__header.html#a1ccca7803ed3bdc007e0d0091061eeed">mac_dst</a>[5], mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[0], mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[1], mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[2],
<a name="l00270"></a>00270                 mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[3], mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[4], mh-&gt;<a class="code" href="structmac__header.html#afcbcd464f2a133de30bd33edae22f296">mac_src</a>[5]);
<a name="l00271"></a>00271                 <span class="keywordflow">if</span> (pkt_data[14] != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l00272"></a>00272                 {
<a name="l00273"></a>00273                     ih = (<a class="code" href="structip__header.html">ip_header</a> *) (pkt_data + 14); <span class="comment">//length of ethernet header</span>
<a name="l00274"></a>00274                     ip_len = (ih-&gt;<a class="code" href="structip__header.html#a5eb344fea96865ef5757d712a23274b4">ver_ihl</a> &amp; 0xf) * 4;
<a name="l00275"></a>00275                     printf(<span class="stringliteral">&quot;%d.%d.%d.%d -&gt; %d.%d.%d.%d %d &quot;</span>,  ih-&gt;<a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">saddr</a>.<a class="code" href="structip__address.html#a9829ac0f8b39812bb17cddc339289799">byte1</a>,  ih-&gt;<a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">saddr</a>.<a class="code" href="structip__address.html#a15fca759942b133e4ded44dd6893134e">byte2</a>,  ih-&gt;<a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">saddr</a>.<a class="code" href="structip__address.html#ab66ba09a8078bd76b2d94d3c473510c0">byte3</a>, ih-&gt;<a class="code" href="structip__header.html#a7171ecc414f6c8c972fe2e70fb189bc3">saddr</a>.<a class="code" href="structip__address.html#af9371530b5b91215d12d5027a3caa1a1">byte4</a>, ih-&gt;<a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">daddr</a>.<a class="code" href="structip__address.html#a9829ac0f8b39812bb17cddc339289799">byte1</a>, ih-&gt;<a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">daddr</a>.<a class="code" href="structip__address.html#a15fca759942b133e4ded44dd6893134e">byte2</a>, ih-&gt;<a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">daddr</a>.<a class="code" href="structip__address.html#ab66ba09a8078bd76b2d94d3c473510c0">byte3</a>, ih-&gt;<a class="code" href="structip__header.html#ac2f83398880dc1299e50da631eb44911">daddr</a>.<a class="code" href="structip__address.html#af9371530b5b91215d12d5027a3caa1a1">byte4</a>, ih-&gt;<a class="code" href="structip__header.html#a6f82f74102352fb10e179da3c7faffde">proto</a>);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277                     <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)ih-&gt;<a class="code" href="structip__header.html#a6f82f74102352fb10e179da3c7faffde">proto</a> == 17) <span class="comment">//UDP</span>
<a name="l00278"></a>00278                     {
<a name="l00279"></a>00279                             printf(<span class="stringliteral">&quot;UDP &quot;</span>);
<a name="l00280"></a>00280                             uh = (<a class="code" href="structudp__header.html">udp_header</a> *)((<a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> *)ih + ip_len);
<a name="l00281"></a>00281                             sport = ntohs(uh-&gt;<a class="code" href="structudp__header.html#a71c74d82739ecf97039e4e29b574f48c">sport</a>);
<a name="l00282"></a>00282                             dport = ntohs(uh-&gt;<a class="code" href="structudp__header.html#a2d40aa44f4eeb0f3a94989955cd598f6">dport</a>);
<a name="l00283"></a>00283                             printf(<span class="stringliteral">&quot;%hu -&gt; %hu\n&quot;</span>, sport, dport);
<a name="l00284"></a>00284                             <span class="keywordflow">return</span>;
<a name="l00285"></a>00285                     }
<a name="l00286"></a>00286                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)ih-&gt;<a class="code" href="structip__header.html#a6f82f74102352fb10e179da3c7faffde">proto</a> == 6) <span class="comment">//TCP</span>
<a name="l00287"></a>00287                     {
<a name="l00288"></a>00288                             printf(<span class="stringliteral">&quot;TCP &quot;</span>);
<a name="l00289"></a>00289                             th = (<a class="code" href="structtcp__header.html">tcp_header</a> *)((<a class="code" href="split__tcp__gateway_8h.html#ae2b02ed168fc99cff3851603910b1fb6">u_char</a> *)ih + ip_len);
<a name="l00290"></a>00290                             sport = ntohs(th-&gt;<a class="code" href="structtcp__header.html#a36d1e56a05521e48f27b290522734462">sport</a>);
<a name="l00291"></a>00291                             dport = ntohs(th-&gt;<a class="code" href="structtcp__header.html#afad92b412e085a6237a98f7dcd0e1744">dport</a>);
<a name="l00292"></a>00292                             seq_num = ntohl(th-&gt;<a class="code" href="structtcp__header.html#ae16e608ea5df1f84820820972c04f45e">seq_num</a>);
<a name="l00293"></a>00293                             ack_num = ntohl(th-&gt;<a class="code" href="structtcp__header.html#ae452d7741f9b70695a797e2bb2608479">ack_num</a>);
<a name="l00294"></a>00294                             tcp_len = ((ntohs(th-&gt;<a class="code" href="structtcp__header.html#a957cd867a63215d329c43eb6a1cfbd4a">hdr_len_resv_code</a>)&amp;0xf000)&gt;&gt;12)*4;
<a name="l00295"></a>00295                             ctr_flag = ntohs(th-&gt;<a class="code" href="structtcp__header.html#a957cd867a63215d329c43eb6a1cfbd4a">hdr_len_resv_code</a>)&amp;0x003f;
<a name="l00296"></a>00296                             <span class="keywordflow">if</span> (header.len &gt; 60)
<a name="l00297"></a>00297                                     data_len = header.len - 14 - ip_len - tcp_len;
<a name="l00298"></a>00298                             <span class="keywordflow">else</span>
<a name="l00299"></a>00299                                     data_len = 0;
<a name="l00300"></a>00300                             printf(<span class="stringliteral">&quot;%hu &quot;</span>, ntohs(th-&gt;<a class="code" href="structtcp__header.html#a957cd867a63215d329c43eb6a1cfbd4a">hdr_len_resv_code</a>)&amp;0x003f);
<a name="l00301"></a>00301                             printf(<span class="stringliteral">&quot;%hu -&gt; %hu %u %u %u\n&quot;</span>, sport, dport, seq_num, ack_num, data_len);
<a name="l00302"></a>00302                             <span class="keywordflow">return</span>;
<a name="l00303"></a>00303                     }
<a name="l00304"></a>00304                 }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306                 printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00307"></a>00307                 <span class="keywordflow">return</span>;
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309 };
<a name="l00310"></a><a class="code" href="structnode.html">00310</a> <span class="keyword">struct </span><a class="code" href="structnode.html">node</a>
<a name="l00311"></a>00311 {
<a name="l00312"></a><a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">00312</a>                 <span class="keywordtype">int</span> <a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a>;
<a name="l00313"></a><a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">00313</a>                 <a class="code" href="structnode.html">node</a> *<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00314"></a>00314 };
<a name="l00315"></a><a class="code" href="classlinklist.html">00315</a> <span class="keyword">class </span><a class="code" href="classlinklist.html">linklist</a>
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317 <span class="keyword">public</span>:
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classlinklist.html#a42f9d72d5d5def91acf484d8c818ccc7">00319</a>         <a class="code" href="structnode.html">node</a> *<a class="code" href="classlinklist.html#a42f9d72d5d5def91acf484d8c818ccc7">p</a>;
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="classlinklist.html#a18d8e4448b81a4910cb6527324e54802">00321</a>         <a class="code" href="classlinklist.html">linklist</a>()
<a name="l00322"></a>00322         {
<a name="l00323"></a>00323                 p=NULL;
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325 
<a name="l00326"></a><a class="code" href="classlinklist.html#a340a7e6dd0df788e816dd65609e6b83c">00326</a>         <span class="keywordtype">void</span> append(<span class="keywordtype">int</span> num)
<a name="l00327"></a>00327         {
<a name="l00328"></a>00328                 <a class="code" href="structnode.html">node</a> *q,*t;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330                 <span class="keywordflow">if</span>( p == NULL )
<a name="l00331"></a>00331                 {
<a name="l00332"></a>00332                         p = <span class="keyword">new</span> <a class="code" href="structnode.html">node</a>;
<a name="l00333"></a>00333                         p-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> = num;
<a name="l00334"></a>00334                         p-&gt;link = NULL;
<a name="l00335"></a>00335                 }
<a name="l00336"></a>00336                 <span class="keywordflow">else</span>
<a name="l00337"></a>00337                 {
<a name="l00338"></a>00338                         q = p;
<a name="l00339"></a>00339                         <span class="keywordflow">while</span>( q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> != NULL )
<a name="l00340"></a>00340                                 q = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342                         t = <span class="keyword">new</span> <a class="code" href="structnode.html">node</a>;
<a name="l00343"></a>00343                         t-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> = num;
<a name="l00344"></a>00344                         t-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = NULL;
<a name="l00345"></a>00345                         q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = t;
<a name="l00346"></a>00346                 }
<a name="l00347"></a>00347         }
<a name="l00348"></a><a class="code" href="classlinklist.html#a29765d5e426d460fdd42a49519323351">00348</a>         <span class="keywordtype">void</span> add_as_first( <span class="keywordtype">int</span> num )
<a name="l00349"></a>00349         {
<a name="l00350"></a>00350                 <a class="code" href="structnode.html">node</a> *q;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352                 q = <span class="keyword">new</span> <a class="code" href="structnode.html">node</a>;
<a name="l00353"></a>00353                 q-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> = num;
<a name="l00354"></a>00354                 q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = p;
<a name="l00355"></a>00355                 p = q;
<a name="l00356"></a>00356         }
<a name="l00357"></a><a class="code" href="classlinklist.html#a4d166c780e44f00a80c89944850a2d6f">00357</a>         <span class="keywordtype">void</span> addafter( <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> num )
<a name="l00358"></a>00358         {
<a name="l00359"></a>00359                 <a class="code" href="structnode.html">node</a> *q,*t;
<a name="l00360"></a>00360                 <span class="keywordtype">int</span> i;
<a name="l00361"></a>00361                 <span class="keywordflow">for</span>(i=0,q=p;i&lt;c;i++)
<a name="l00362"></a>00362                 {
<a name="l00363"></a>00363                         q = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00364"></a>00364                         <span class="keywordflow">if</span>(q == NULL )
<a name="l00365"></a>00365                         {
<a name="l00366"></a>00366                                 printf(<span class="stringliteral">&quot;There are less than %d elements\n&quot;</span>, c);
<a name="l00367"></a>00367                                 <span class="keywordflow">return</span>;
<a name="l00368"></a>00368                         }
<a name="l00369"></a>00369                 }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371                 t = <span class="keyword">new</span> <a class="code" href="structnode.html">node</a>;
<a name="l00372"></a>00372                 t-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> = num;
<a name="l00373"></a>00373                 t-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00374"></a>00374                 q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = t;
<a name="l00375"></a>00375         }
<a name="l00376"></a><a class="code" href="classlinklist.html#a0005103ddb185c304495483e224201bd">00376</a>         <span class="keywordtype">void</span> del(<span class="keywordtype">int</span> num)
<a name="l00377"></a>00377         {
<a name="l00378"></a>00378                 <a class="code" href="structnode.html">node</a> *q,*r;
<a name="l00379"></a>00379                 q = p;
<a name="l00380"></a>00380                 <span class="keywordflow">if</span>( q-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> == num )
<a name="l00381"></a>00381                 {
<a name="l00382"></a>00382                          p = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00383"></a>00383                          <span class="keyword">delete</span> q;
<a name="l00384"></a>00384                          <span class="keywordflow">return</span>;
<a name="l00385"></a>00385                 }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387                 r = q;
<a name="l00388"></a>00388                 <span class="keywordflow">while</span>( q!=NULL )
<a name="l00389"></a>00389                 {
<a name="l00390"></a>00390                         <span class="keywordflow">if</span>( q-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a> == num )
<a name="l00391"></a>00391                         {
<a name="l00392"></a>00392                                 r-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00393"></a>00393                                 <span class="keyword">delete</span> q;
<a name="l00394"></a>00394                                 <span class="keywordflow">return</span>;
<a name="l00395"></a>00395                         }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397                         r = q;
<a name="l00398"></a>00398                         q = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00399"></a>00399                 }
<a name="l00400"></a>00400                 printf(<span class="stringliteral">&quot;Element %d not Found\n&quot;</span>, num);
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="classlinklist.html#a9bdd2eacd02572167b4e2c98791f4054">00403</a>         <span class="keywordtype">void</span> display()
<a name="l00404"></a>00404         {
<a name="l00405"></a>00405                 <a class="code" href="structnode.html">node</a> *q;
<a name="l00406"></a>00406                 <span class="keywordflow">for</span>(q = p ; q != NULL ; q = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>)
<a name="l00407"></a>00407                         printf(<span class="stringliteral">&quot;%d\n&quot;</span>, q-&gt;<a class="code" href="structnode.html#a2d890bb9f6af0ffd73fe79b21124c2a2">data</a>);
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409 
<a name="l00410"></a><a class="code" href="classlinklist.html#a244ea3939fd959b4c386bd931c46621c">00410</a>         <span class="keywordtype">int</span> count()
<a name="l00411"></a>00411         {
<a name="l00412"></a>00412                 <a class="code" href="structnode.html">node</a> *q;
<a name="l00413"></a>00413                 <span class="keywordtype">int</span> c=0;
<a name="l00414"></a>00414                 <span class="keywordflow">for</span>( q=p ; q != NULL ; q = q-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a> )
<a name="l00415"></a>00415                         c++;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417                 <span class="keywordflow">return</span> c;
<a name="l00418"></a>00418         }
<a name="l00419"></a>00419 
<a name="l00420"></a><a class="code" href="classlinklist.html#a6791b18d7d5c39ab4ab5bacaf90bd4ba">00420</a>         ~<a class="code" href="classlinklist.html">linklist</a>()
<a name="l00421"></a>00421         {
<a name="l00422"></a>00422                 <a class="code" href="structnode.html">node</a> *q;
<a name="l00423"></a>00423                 <span class="keywordflow">if</span>( p == NULL )
<a name="l00424"></a>00424                         <span class="keywordflow">return</span>;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426                 <span class="keywordflow">while</span>( p != NULL )
<a name="l00427"></a>00427                 {
<a name="l00428"></a>00428                         q = p-&gt;<a class="code" href="structnode.html#af23d89eee1b0584d8eaf9a2e8d8f25ee">link</a>;
<a name="l00429"></a>00429                         <span class="keyword">delete</span> p;
<a name="l00430"></a>00430                         p = q;
<a name="l00431"></a>00431                 }
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433 };
<a name="l00434"></a><a class="code" href="structstate__array.html">00434</a> <span class="keyword">struct </span><a class="code" href="structstate__array.html">state_array</a>
<a name="l00435"></a>00435 {
<a name="l00436"></a><a class="code" href="structstate__array.html#ac02f9e6d479a4f13a32854bc61cfcf5b">00436</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> state_id[<a class="code" href="split__tcp__gateway_8h.html#a72a5443d670bf99c8273f32847315e23">TOTAL_NUM_CONN</a>];
<a name="l00437"></a><a class="code" href="structstate__array.html#ae6109c63ad4a783b9139e94fced30e88">00437</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structstate__array.html#ae6109c63ad4a783b9139e94fced30e88">num</a>;
<a name="l00438"></a><a class="code" href="structstate__array.html#ae6a64dd5b24526cf07bdd8b848505e4c">00438</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structstate__array.html#ae6a64dd5b24526cf07bdd8b848505e4c">it</a>;
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="structstate__array.html#a8f4ad00bb6cd0c60ceec45a7bb5e2fa8">00440</a>         <a class="code" href="structstate__array.html">state_array</a>()
<a name="l00441"></a>00441         {
<a name="l00442"></a>00442                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; <a class="code" href="split__tcp__gateway_8h.html#a72a5443d670bf99c8273f32847315e23">TOTAL_NUM_CONN</a>; i ++)
<a name="l00443"></a>00443                 {
<a name="l00444"></a>00444                         state_id[i] = 0;
<a name="l00445"></a>00445                 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447                 num = 0;
<a name="l00448"></a>00448                 it = 0;
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450 
<a name="l00451"></a><a class="code" href="structstate__array.html#a4e9235c5a34ea3d49acd71a4680532de">00451</a>         <a class="code" href="split__tcp__gateway_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> isEmpty()
<a name="l00452"></a>00452         {
<a name="l00453"></a>00453                 <span class="keywordflow">if</span> (!num)
<a name="l00454"></a>00454                         <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00455"></a>00455                 <span class="keywordflow">else</span>
<a name="l00456"></a>00456                         <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00457"></a>00457         }
<a name="l00458"></a>00458 
<a name="l00459"></a><a class="code" href="structstate__array.html#a1c8df30c95c0c53bdf327692bbd1485e">00459</a>         <span class="keywordtype">void</span> flush()
<a name="l00460"></a>00460         {
<a name="l00461"></a>00461                 num = it = 0;
<a name="l00462"></a>00462                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; <a class="code" href="split__tcp__gateway_8h.html#a72a5443d670bf99c8273f32847315e23">TOTAL_NUM_CONN</a>; i ++)
<a name="l00463"></a>00463                 {
<a name="l00464"></a>00464                         state_id[i] = 0;
<a name="l00465"></a>00465                 }
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467 
<a name="l00468"></a><a class="code" href="structstate__array.html#a43f0ead49c43a420666d6987fa25ce72">00468</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> iterator()
<a name="l00469"></a>00469         {
<a name="l00470"></a>00470                 <span class="keywordflow">return</span> it;
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="structstate__array.html#a606d900f2b6b2c605177e6df2bc8d723">00473</a>         <span class="keywordtype">void</span> next()
<a name="l00474"></a>00474         {
<a name="l00475"></a>00475                 <span class="keywordflow">if</span> (num)
<a name="l00476"></a>00476                         it = (it + 1) % num;
<a name="l00477"></a>00477         }
<a name="l00478"></a>00478 
<a name="l00479"></a><a class="code" href="structstate__array.html#a8ab10b94f881ebd477e763f74c42318c">00479</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> size()
<a name="l00480"></a>00480         {
<a name="l00481"></a>00481                 <span class="keywordflow">return</span> num;
<a name="l00482"></a>00482         }
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="structstate__array.html#a1bbc64c3c548259b62d2cba589ec4964">00484</a>         <a class="code" href="split__tcp__gateway_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> find(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> port)
<a name="l00485"></a>00485         {
<a name="l00486"></a>00486                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; num; i ++)
<a name="l00487"></a>00487                 {
<a name="l00488"></a>00488                         <span class="keywordflow">if</span> (state_id[i] == port)
<a name="l00489"></a>00489                                 <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00490"></a>00490                 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492                 <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494 
<a name="l00495"></a><a class="code" href="structstate__array.html#adbcc0a5d7421099327ebef5cf4d3759f">00495</a>         <span class="keywordtype">void</span> add(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> port)
<a name="l00496"></a>00496         {
<a name="l00497"></a>00497                 state_id[num] = port;
<a name="l00498"></a>00498                 num ++;
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="structstate__array.html#ad2b4e53b6f6f9768be3702625741677f">00501</a>         <span class="keywordtype">void</span> del(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> index)
<a name="l00502"></a>00502         {
<a name="l00503"></a>00503                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = index; i &lt; num - 1; i ++)
<a name="l00504"></a>00504                         state_id[i] = state_id[i + 1];
<a name="l00505"></a>00505                 state_id[num - 1] = 0;
<a name="l00506"></a>00506                 num --;
<a name="l00507"></a>00507                 <span class="keywordflow">if</span> (num)
<a name="l00508"></a>00508                         it = index % num;
<a name="l00509"></a>00509                 <span class="keywordflow">else</span>
<a name="l00510"></a>00510                         it = 0;
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         }
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="structstate__array.html#a46f49bb35e00915fc4e6a82ae386506a">00514</a>         <span class="keywordtype">void</span> deleteByValue(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> port)
<a name="l00515"></a>00515         {
<a name="l00516"></a>00516                 <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> index;
<a name="l00517"></a>00517                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; num; i ++)
<a name="l00518"></a>00518                 {
<a name="l00519"></a>00519                         <span class="keywordflow">if</span> (state_id[i] == port)
<a name="l00520"></a>00520                         {
<a name="l00521"></a>00521                                 index = i;
<a name="l00522"></a>00522                                 <span class="keywordflow">break</span>;
<a name="l00523"></a>00523                         }
<a name="l00524"></a>00524                 }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526                 del(index);
<a name="l00527"></a>00527         }
<a name="l00528"></a>00528 };
<a name="l00529"></a><a class="code" href="structForwardPktBuffer.html">00529</a> <span class="keyword">struct </span><a class="code" href="structForwardPktBuffer.html">ForwardPktBuffer</a>
<a name="l00530"></a>00530 {
<a name="l00531"></a><a class="code" href="structForwardPktBuffer.html#a866acba6e91da3aff9ff3cfd6512cfe3">00531</a>         <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#a866acba6e91da3aff9ff3cfd6512cfe3">pktQueue</a>;
<a name="l00532"></a>00532 
<a name="l00533"></a><a class="code" href="structForwardPktBuffer.html#ae26212d7d81169449af0050f4ba6deb3">00533</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPktBuffer.html#ae26212d7d81169449af0050f4ba6deb3">capacity</a>, _size, _head, _tail, _unAck, _pkts, _last_head, _last_pkts;
<a name="l00534"></a>00534 
<a name="l00535"></a><a class="code" href="structForwardPktBuffer.html#ac9584cfd467108b002be94236c8629ef">00535</a>         <a class="code" href="structForwardPktBuffer.html">ForwardPktBuffer</a>(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> size):capacity(size)
<a name="l00536"></a>00536         {
<a name="l00537"></a>00537                 pktQueue = (<a class="code" href="structForwardPkt.html">ForwardPkt</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structForwardPkt.html">ForwardPkt</a>)*capacity);
<a name="l00538"></a>00538                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; capacity; i ++)
<a name="l00539"></a>00539                         pktQueue[i].initPkt();
<a name="l00540"></a>00540 
<a name="l00541"></a>00541                 _head = _tail = _size = _unAck = _pkts = _last_head = _last_pkts = 0;
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543 
<a name="l00544"></a><a class="code" href="structForwardPktBuffer.html#aa300ecfe0f0db3647927dbf3a302ec1f">00544</a>         <span class="keywordtype">void</span> <span class="keyword">inline</span> flush()
<a name="l00545"></a>00545         {
<a name="l00546"></a>00546                 init();
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="structForwardPktBuffer.html#a8a76f9bc514fe9ef44368329bff75b0b">00549</a>         ~<a class="code" href="structForwardPktBuffer.html">ForwardPktBuffer</a>()
<a name="l00550"></a>00550         {
<a name="l00551"></a>00551                 free(pktQueue);
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553 
<a name="l00554"></a><a class="code" href="structForwardPktBuffer.html#ad8e1d43a1bfc6e49ca0912122bf2e19e">00554</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> init()
<a name="l00555"></a>00555         {
<a name="l00556"></a>00556                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; capacity; i ++)
<a name="l00557"></a>00557                         pktQueue[i].initPkt();
<a name="l00558"></a>00558 
<a name="l00559"></a>00559                 _head = _tail = _size = _unAck = _pkts = _last_head = _last_pkts = 0;
<a name="l00560"></a>00560         }
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="structForwardPktBuffer.html#aad2e902ed1a92bc5b80bfc93776f5c16">00562</a>         <span class="keyword">inline</span> <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#aad2e902ed1a92bc5b80bfc93776f5c16">unAck</a>() { <span class="keywordflow">return</span> pktQueue + (_unAck % capacity); }
<a name="l00563"></a><a class="code" href="structForwardPktBuffer.html#a6f5ec5079172b6c7595c3c45f61de9c0">00563</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#a6f5ec5079172b6c7595c3c45f61de9c0">unAckNext</a>() { _unAck = (_unAck + 1) % capacity; }
<a name="l00564"></a><a class="code" href="structForwardPktBuffer.html#a73b22adb70c22ae8cb705d14d9732ad5">00564</a>         <span class="keyword">inline</span> <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#a73b22adb70c22ae8cb705d14d9732ad5">head</a>() { <span class="keywordflow">return</span> pktQueue + (_head % capacity); }
<a name="l00565"></a><a class="code" href="structForwardPktBuffer.html#a26159c76aa5c397e2c66edef65f14930">00565</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#a26159c76aa5c397e2c66edef65f14930">headNext</a>() { _head = (_head + 1) % capacity; _pkts --; }
<a name="l00566"></a><a class="code" href="structForwardPktBuffer.html#a76524c3b6e4ea282ef33c2bb3b8e4ec9">00566</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> headPrev()
<a name="l00567"></a>00567         {
<a name="l00568"></a>00568             <span class="keywordflow">if</span> (_head == 0)
<a name="l00569"></a>00569                 _head = capacity - 1;
<a name="l00570"></a>00570             <span class="keywordflow">else</span>
<a name="l00571"></a>00571                 _head = (_head - 1) % capacity;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573             _pkts ++;
<a name="l00574"></a>00574         }
<a name="l00575"></a><a class="code" href="structForwardPktBuffer.html#aeecf04727afb67f81039d7107e44772d">00575</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#aeecf04727afb67f81039d7107e44772d">lastHeadNext</a>() { _last_head = (_last_head + 1) % capacity; _last_pkts --; }
<a name="l00576"></a><a class="code" href="structForwardPktBuffer.html#ac001d467de52d16996b442fd2ccba0cb">00576</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> lastHeadPrev()
<a name="l00577"></a>00577         {
<a name="l00578"></a>00578             <span class="keywordflow">if</span> (_last_head == 0)
<a name="l00579"></a>00579                 _last_head = capacity - 1;
<a name="l00580"></a>00580             <span class="keywordflow">else</span>
<a name="l00581"></a>00581                 _last_head = (_last_head - 1) % capacity;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583             _last_pkts ++;
<a name="l00584"></a>00584 
<a name="l00585"></a>00585         }
<a name="l00586"></a><a class="code" href="structForwardPktBuffer.html#a4a90b0d9aa5e1676d24daaee6a507b02">00586</a>         <span class="keyword">inline</span> <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#a4a90b0d9aa5e1676d24daaee6a507b02">lastHead</a>() { <span class="keywordflow">return</span> pktQueue + (_last_head % capacity); }
<a name="l00587"></a><a class="code" href="structForwardPktBuffer.html#aaf7dd9ce5921b8beaa7e081fa46a6231">00587</a>         <span class="keyword">inline</span> <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#aaf7dd9ce5921b8beaa7e081fa46a6231">tail</a>() { <span class="keywordflow">return</span> pktQueue + (_tail % capacity); }
<a name="l00588"></a><a class="code" href="structForwardPktBuffer.html#ac9ccddc69b97ffa0a58743c12b5e8ac0">00588</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#ac9ccddc69b97ffa0a58743c12b5e8ac0">tailNext</a>() { _tail = (_tail + 1) % capacity; _pkts ++; }
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="structForwardPktBuffer.html#aee4c3a9dc43b3f156a7927446b0a26fa">00590</a>         <span class="keyword">inline</span> <a class="code" href="structForwardPkt.html">ForwardPkt</a>* <a class="code" href="structForwardPktBuffer.html#aee4c3a9dc43b3f156a7927446b0a26fa">pkt</a>(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _index) { <span class="keywordflow">return</span> pktQueue + (_index % capacity); }
<a name="l00591"></a><a class="code" href="structForwardPktBuffer.html#a5d282f10502b24b771e423008c4c9372">00591</a>         <span class="keyword">inline</span> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPktBuffer.html#a5d282f10502b24b771e423008c4c9372">pktNext</a>(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _index) { <span class="keywordflow">return</span> _index = (_index + 1) % capacity; }
<a name="l00592"></a>00592 
<a name="l00593"></a><a class="code" href="structForwardPktBuffer.html#a6fb6ca6a471d0ee250200493f2448575">00593</a>         <span class="keyword">inline</span> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPktBuffer.html#a6fb6ca6a471d0ee250200493f2448575">size</a>() { <span class="keywordflow">return</span> _size; }
<a name="l00594"></a><a class="code" href="structForwardPktBuffer.html#a4c166d1f4d2700f314a3fd36e56a558a">00594</a>         <span class="keyword">inline</span> <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForwardPktBuffer.html#a4c166d1f4d2700f314a3fd36e56a558a">pkts</a>() { <span class="keywordflow">return</span> _pkts; }
<a name="l00595"></a>00595 
<a name="l00596"></a><a class="code" href="structForwardPktBuffer.html#a8256fedfc3464efda2656bf02717c341">00596</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#a8256fedfc3464efda2656bf02717c341">increase</a>() { _size ++; }
<a name="l00597"></a><a class="code" href="structForwardPktBuffer.html#ac486921a6c444b3612be100c0bae4fc9">00597</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structForwardPktBuffer.html#ac486921a6c444b3612be100c0bae4fc9">decrease</a>() { _size --; }
<a name="l00598"></a>00598 };
<a name="l00599"></a><a class="code" href="structPacket.html">00599</a> <span class="keyword">struct </span><a class="code" href="structPacket.html">Packet</a>
<a name="l00600"></a>00600 {
<a name="l00601"></a><a class="code" href="structPacket.html#a2537f6833c51db41038bf502b721ed91">00601</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structPacket.html#a2537f6833c51db41038bf502b721ed91">seqNo</a>;
<a name="l00602"></a><a class="code" href="structPacket.html#a950f60eaf6443b79fb6b8b926e2241a7">00602</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structPacket.html#a950f60eaf6443b79fb6b8b926e2241a7">time</a>;
<a name="l00603"></a><a class="code" href="structPacket.html#afe3ceedba29480dbfb84b7aca896f8d4">00603</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structPacket.html#afe3ceedba29480dbfb84b7aca896f8d4">len</a>;
<a name="l00604"></a>00604 
<a name="l00605"></a><a class="code" href="structPacket.html#aabcfb963c0d5bc0fa554668f92989622">00605</a>         <a class="code" href="structPacket.html">Packet</a>()
<a name="l00606"></a>00606         {
<a name="l00607"></a>00607                 len = seqNo = time = 0;
<a name="l00608"></a>00608         }
<a name="l00609"></a>00609 
<a name="l00610"></a><a class="code" href="structPacket.html#a38366020098462e86f96b1c0ad80bb60">00610</a>         <span class="keywordtype">void</span> flush()
<a name="l00611"></a>00611         {
<a name="l00612"></a>00612                 len = seqNo = time = 0;
<a name="l00613"></a>00613         }
<a name="l00614"></a>00614 };
<a name="l00615"></a><a class="code" href="structSlideWindow.html">00615</a> <span class="keyword">struct </span><a class="code" href="structSlideWindow.html">SlideWindow</a>
<a name="l00616"></a>00616 {
<a name="l00617"></a><a class="code" href="structSlideWindow.html#ac2d24fae7063beaab8681575f9a455f3">00617</a>         <a class="code" href="structPacket.html">Packet</a>* <a class="code" href="structSlideWindow.html#ac2d24fae7063beaab8681575f9a455f3">window</a>;
<a name="l00618"></a><a class="code" href="structSlideWindow.html#a69f61dc9df272d8c5f2723b142dab638">00618</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _size, _bytes, capacity, delta, <a class="code" href="structSlideWindow.html#a69f61dc9df272d8c5f2723b142dab638">interval</a>;
<a name="l00619"></a><a class="code" href="structSlideWindow.html#ac6ddc4f86ffd3dc624ca0b710c9701d0">00619</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> <a class="code" href="structSlideWindow.html#ac6ddc4f86ffd3dc624ca0b710c9701d0">sample_time</a>;
<a name="l00620"></a>00620 
<a name="l00621"></a><a class="code" href="structSlideWindow.html#af3f608e78c352ca987d7584cb9383cd5">00621</a>         <a class="code" href="structSlideWindow.html">SlideWindow</a>(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> size, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _interval, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _delta)
<a name="l00622"></a>00622         {
<a name="l00623"></a>00623                 capacity = size;
<a name="l00624"></a>00624                 delta = _delta;
<a name="l00625"></a>00625                 interval = _interval;
<a name="l00626"></a>00626                 window = (<a class="code" href="structPacket.html">Packet</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structPacket.html">Packet</a>) * size);
<a name="l00627"></a>00627                 _size = _bytes = sample_time = 0;
<a name="l00628"></a>00628         }
<a name="l00629"></a>00629 
<a name="l00630"></a><a class="code" href="structSlideWindow.html#acdf4f09254d2d9d9cc8b06a2efe5bf68">00630</a>         ~<a class="code" href="structSlideWindow.html">SlideWindow</a>()
<a name="l00631"></a>00631         {
<a name="l00632"></a>00632                 free(window);
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634 
<a name="l00635"></a><a class="code" href="structSlideWindow.html#a88c69cd1183ae70c3d09ab252df7c38f">00635</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> size()
<a name="l00636"></a>00636         {
<a name="l00637"></a>00637           <span class="keywordflow">return</span> _size;
<a name="l00638"></a>00638         }
<a name="l00639"></a>00639 
<a name="l00640"></a><a class="code" href="structSlideWindow.html#a52ab3c3d01750d81b6358db65e4e6146">00640</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> bytes()
<a name="l00641"></a>00641         {
<a name="l00642"></a>00642           <span class="keywordflow">return</span> _bytes;
<a name="l00643"></a>00643         }
<a name="l00644"></a>00644 
<a name="l00645"></a><a class="code" href="structSlideWindow.html#aab9759f652d68733e974dedcae3e23b5">00645</a>         <a class="code" href="split__tcp__gateway_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> isEmpty()
<a name="l00646"></a>00646         {
<a name="l00647"></a>00647           <span class="keywordflow">if</span> (_size == 0)
<a name="l00648"></a>00648              <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00649"></a>00649           <span class="keywordflow">else</span>
<a name="l00650"></a>00650              <span class="keywordflow">return</span> <a class="code" href="split__tcp__gateway_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00651"></a>00651         }
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="structSlideWindow.html#abd00c475ba43503b4c15e08488669efb">00653</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> bytesCount()
<a name="l00654"></a>00654         {
<a name="l00655"></a>00655           <span class="keywordflow">if</span> (isEmpty())
<a name="l00656"></a>00656           {
<a name="l00657"></a>00657              <span class="keywordflow">return</span> 0;
<a name="l00658"></a>00658           }
<a name="l00659"></a>00659           <span class="keywordflow">else</span>
<a name="l00660"></a>00660              <span class="keywordflow">return</span> window[_size-1].seqNo - window[0].seqNo;
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662 
<a name="l00663"></a><a class="code" href="structSlideWindow.html#ad247dbb8b5c4ddff2784c63469bb7efe">00663</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> frontTime()
<a name="l00664"></a>00664         {
<a name="l00665"></a>00665           <span class="keywordflow">return</span> window[0].time;
<a name="l00666"></a>00666         }
<a name="l00667"></a>00667 
<a name="l00668"></a><a class="code" href="structSlideWindow.html#acea36a8d11e07653a253aa66580a0945">00668</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> tailTime()
<a name="l00669"></a>00669         {
<a name="l00670"></a>00670           <span class="keywordflow">if</span> (isEmpty())
<a name="l00671"></a>00671             <span class="keywordflow">return</span> 0;
<a name="l00672"></a>00672           <span class="keywordflow">else</span>
<a name="l00673"></a>00673             <span class="keywordflow">return</span> window[_size-1].time;
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675 
<a name="l00676"></a><a class="code" href="structSlideWindow.html#aaacd6e9090b5f22e15ca5fdf2b4a2953">00676</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> estmateInterval(<a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> current_time)
<a name="l00677"></a>00677         {
<a name="l00678"></a>00678                 <span class="keywordflow">if</span> (!sample_time)
<a name="l00679"></a>00679                     <span class="keywordflow">return</span> 0;
<a name="l00680"></a>00680                 <span class="keywordflow">else</span>
<a name="l00681"></a>00681                     <span class="keywordflow">return</span> current_time - sample_time;
<a name="l00682"></a>00682         }
<a name="l00683"></a>00683 
<a name="l00684"></a><a class="code" href="structSlideWindow.html#ad5e297c278c4e9a4eb3b94ed04ef50a8">00684</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> nextEstmateSampleTime(<a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> current_time)
<a name="l00685"></a>00685         {
<a name="l00686"></a>00686                 <span class="keywordflow">if</span> (!sample_time)
<a name="l00687"></a>00687                 {
<a name="l00688"></a>00688                     sample_time = current_time;
<a name="l00689"></a>00689                     <span class="keywordflow">return</span> sample_time;
<a name="l00690"></a>00690                 }
<a name="l00691"></a>00691                 <span class="keywordflow">else</span>
<a name="l00692"></a>00692                 {
<a name="l00693"></a>00693                     sample_time += delta;
<a name="l00694"></a>00694                     <span class="keywordflow">return</span> sample_time;
<a name="l00695"></a>00695                 }
<a name="l00696"></a>00696         }
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="structSlideWindow.html#ac2fb850f95b80f16f097d87a98e4c2d9">00698</a>         <span class="keywordtype">void</span> another_shift()
<a name="l00699"></a>00699         {
<a name="l00700"></a>00700                 <span class="keywordflow">while</span> (frontTime() &lt; sample_time &amp;&amp; _bytes &gt; 0 &amp;&amp; _size &gt;= 2)
<a name="l00701"></a>00701                 {
<a name="l00702"></a>00702                         shift();
<a name="l00703"></a>00703                         _size --;
<a name="l00704"></a>00704                 }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         }
<a name="l00707"></a><a class="code" href="structSlideWindow.html#a70a3e8ddc79035834c9afbbc3b1564dc">00707</a>         <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> timeInterval(<a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> current_time)
<a name="l00708"></a>00708         {
<a name="l00709"></a>00709                 <span class="keywordflow">if</span> (isEmpty())
<a name="l00710"></a>00710                         <span class="keywordflow">return</span> 0;
<a name="l00711"></a>00711                 <span class="keywordflow">else</span>
<a name="l00712"></a>00712                         <span class="keywordflow">return</span> current_time - window[0].time;
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714 
<a name="l00715"></a><a class="code" href="structSlideWindow.html#afdf1309621516515ab3c0aa382d7d968">00715</a>         <span class="keywordtype">void</span> shift()
<a name="l00716"></a>00716         {
<a name="l00717"></a>00717                 _bytes -= window[0].len;
<a name="l00718"></a>00718                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; _size - 1; i ++)
<a name="l00719"></a>00719                 {
<a name="l00720"></a>00720                         window[i].len = window[i+1].len;
<a name="l00721"></a>00721                         window[i].time = window[i+1].time;
<a name="l00722"></a>00722                         window[i].seqNo = window[i+1].seqNo;
<a name="l00723"></a>00723                 }
<a name="l00724"></a>00724         }
<a name="l00725"></a>00725 
<a name="l00726"></a><a class="code" href="structSlideWindow.html#ab6a270ae70611ba0c8f4d84a0ff05bc9">00726</a>         <span class="keywordtype">void</span> put(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> len, <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> time, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> seqNo)
<a name="l00727"></a>00727         {
<a name="l00728"></a>00728                 <span class="keywordflow">if</span> (_size &lt; capacity)
<a name="l00729"></a>00729                 {
<a name="l00730"></a>00730                         window[_size].len = len;
<a name="l00731"></a>00731                         window[_size].time = time;
<a name="l00732"></a>00732                         window[_size].seqNo = seqNo;
<a name="l00733"></a>00733                         _bytes += window[_size].len;
<a name="l00734"></a>00734                         _size ++;
<a name="l00735"></a>00735                 }
<a name="l00736"></a>00736                 <span class="keywordflow">else</span>
<a name="l00737"></a>00737                 {
<a name="l00738"></a>00738                         assert(_size == capacity);
<a name="l00739"></a>00739 
<a name="l00740"></a>00740                         shift();
<a name="l00741"></a>00741                         window[_size-1].len = len;
<a name="l00742"></a>00742                         window[_size-1].time = time;
<a name="l00743"></a>00743                         window[_size-1].seqNo = seqNo;
<a name="l00744"></a>00744                         _bytes += window[_size-1].len;
<a name="l00745"></a>00745                 }
<a name="l00746"></a>00746         }
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="structSlideWindow.html#adc22f3475c302f74a9cfe4e9a005bc3d">00748</a>         <span class="keywordtype">void</span> another_put(<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> len, <a class="code" href="split__tcp__gateway_8h.html#ae16666ecf73bb70201bc64a6ccc329f1">u_long_long</a> time, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> seqNo)
<a name="l00749"></a>00749         {
<a name="l00750"></a>00750 
<a name="l00751"></a>00751                 <span class="keywordflow">if</span> (_size &lt; capacity)
<a name="l00752"></a>00752                 {
<a name="l00753"></a>00753                         window[_size].len = len;
<a name="l00754"></a>00754                         window[_size].time = time;
<a name="l00755"></a>00755                         window[_size].seqNo = seqNo;
<a name="l00756"></a>00756                         _bytes += window[_size].len;
<a name="l00757"></a>00757                         _size ++;
<a name="l00758"></a>00758                 }
<a name="l00759"></a>00759                 <span class="keywordflow">else</span>
<a name="l00760"></a>00760                 {
<a name="l00761"></a>00761                         assert(_size == capacity);
<a name="l00762"></a>00762 
<a name="l00763"></a>00763                         shift();
<a name="l00764"></a>00764                         window[_size-1].len = len;
<a name="l00765"></a>00765                         window[_size-1].time = time;
<a name="l00766"></a>00766                         window[_size-1].seqNo = seqNo;
<a name="l00767"></a>00767                         _bytes += window[_size-1].len;
<a name="l00768"></a>00768                 }
<a name="l00769"></a>00769         }
<a name="l00770"></a>00770 
<a name="l00771"></a><a class="code" href="structSlideWindow.html#aa0097fa63e6d837a8ae73168f819fa91">00771</a>         <span class="keywordtype">void</span> flush()
<a name="l00772"></a>00772         {
<a name="l00773"></a>00773                 _size = _bytes = sample_time = 0;
<a name="l00774"></a>00774                 <span class="keywordflow">for</span> (<a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> i = 0; i &lt; capacity; i ++)
<a name="l00775"></a>00775                         window[i].flush();
<a name="l00776"></a>00776         }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 };
<a name="l00779"></a><a class="code" href="structForward.html">00779</a> <span class="keyword">struct </span><a class="code" href="structForward.html">Forward</a>
<a name="l00780"></a>00780 {
<a name="l00781"></a><a class="code" href="structForward.html#a43e491c45dd179910e10c5f2bf9d4f01">00781</a>         pcap_t *<a class="code" href="structForward.html#a43e491c45dd179910e10c5f2bf9d4f01">dev</a>;
<a name="l00782"></a><a class="code" href="structForward.html#a67d0465a472fe58ca483f0da0b76f709">00782</a>         <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> <a class="code" href="structForward.html#a67d0465a472fe58ca483f0da0b76f709">delay</a>;
<a name="l00783"></a><a class="code" href="structForward.html#a59a8b69d061964b2e52646f7a0083214">00783</a>         <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">DIRECTION</a> <a class="code" href="structForward.html#a59a8b69d061964b2e52646f7a0083214">mode</a>;
<a name="l00784"></a>00784 
<a name="l00785"></a><a class="code" href="structForward.html#adbe26a18bde40343ed7c21e282debc08">00785</a>         <a class="code" href="structForwardPktBuffer.html">ForwardPktBuffer</a> <a class="code" href="structForward.html#adbe26a18bde40343ed7c21e282debc08">pktQueue</a>;
<a name="l00786"></a><a class="code" href="structForward.html#abb4b4581a071b8a44c708f853771d8ed">00786</a>         pthread_mutex_t <a class="code" href="structForward.html#abb4b4581a071b8a44c708f853771d8ed">mutex</a>;
<a name="l00787"></a>00787 
<a name="l00788"></a><a class="code" href="structForward.html#ab6d55b3935b255bde55089bfe53fc101">00788</a>         pthread_cond_t <a class="code" href="structForward.html#ab6d55b3935b255bde55089bfe53fc101">m_eventElementAvailable</a>;
<a name="l00789"></a><a class="code" href="structForward.html#a1cb73933205227fcc53684e1d9be708e">00789</a>         pthread_cond_t <a class="code" href="structForward.html#a1cb73933205227fcc53684e1d9be708e">m_eventSpaceAvailable</a>;
<a name="l00790"></a>00790 
<a name="l00791"></a><a class="code" href="structForward.html#ae74a6419b39145e74e6b6a30641e3728">00791</a>         <a class="code" href="structForward.html">Forward</a>(pcap_t *_dev, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> count, <a class="code" href="split__tcp__gateway_8h.html#ac319c165d52643e43249fe003e18bdf3">u_int</a> _delay, <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">DIRECTION</a> _mode) : dev(_dev), delay(_delay), mode(_mode), pktQueue(count)
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793                 pthread_mutex_init(&amp;mutex, NULL);
<a name="l00794"></a>00794                 pthread_cond_init(&amp;m_eventSpaceAvailable, NULL );
<a name="l00795"></a>00795                 pthread_cond_init(&amp;m_eventElementAvailable, NULL);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797         }
<a name="l00798"></a>00798 
<a name="l00799"></a><a class="code" href="structForward.html#af018f03fdfd0e58c653bbb8411b77ef0">00799</a>         ~<a class="code" href="structForward.html">Forward</a>()
<a name="l00800"></a>00800         {
<a name="l00801"></a>00801                 pthread_mutex_destroy(&amp;mutex);
<a name="l00802"></a>00802                 pthread_cond_destroy(&amp;m_eventElementAvailable);
<a name="l00803"></a>00803                 pthread_cond_destroy(&amp;m_eventSpaceAvailable);
<a name="l00804"></a>00804         }
<a name="l00805"></a>00805 };
<a name="l00806"></a><a class="code" href="structDATA.html">00806</a> <span class="keyword">struct </span><a class="code" href="structDATA.html">DATA</a>
<a name="l00807"></a>00807 {
<a name="l00808"></a><a class="code" href="structDATA.html#a2b6e3861cd032d77e6bcede1ce8eac80">00808</a>         pcap_t *<a class="code" href="structDATA.html#a2b6e3861cd032d77e6bcede1ce8eac80">dev_this</a>;
<a name="l00809"></a><a class="code" href="structDATA.html#ad6cc6765ab22cb11a31b8b51d6449a41">00809</a>         pcap_t *<a class="code" href="structDATA.html#ad6cc6765ab22cb11a31b8b51d6449a41">dev_another</a>;
<a name="l00810"></a><a class="code" href="structDATA.html#af8b5b656a5e237ad7d2f5cdcca9fcce4">00810</a>         <span class="keywordtype">char</span> *<a class="code" href="structDATA.html#af8b5b656a5e237ad7d2f5cdcca9fcce4">name_this</a>;
<a name="l00811"></a><a class="code" href="structDATA.html#a81d07e70e9d1fdabf83cacd194606190">00811</a>         <span class="keywordtype">char</span> *<a class="code" href="structDATA.html#a81d07e70e9d1fdabf83cacd194606190">name_another</a>;
<a name="l00812"></a><a class="code" href="structDATA.html#ae913982f5e9e79eb6da5ca9f4b43c753">00812</a>         <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">DIRECTION</a> <a class="code" href="structDATA.html#ae913982f5e9e79eb6da5ca9f4b43c753">mode</a>;
<a name="l00813"></a><a class="code" href="structDATA.html#ac695dab2d15b6a320ba208820d89fe8b">00813</a>         <a class="code" href="structForward.html">Forward</a> *forward, *<a class="code" href="structDATA.html#ac695dab2d15b6a320ba208820d89fe8b">forward_back</a>;
<a name="l00814"></a><a class="code" href="structDATA.html#a9ab2df800d4d701a6aa6baa28b7757aa">00814</a>         <a class="code" href="structDATA.html#a9ab2df800d4d701a6aa6baa28b7757aa">DATA</a>(pcap_t *dev_0, pcap_t *dev_1, <span class="keywordtype">char</span> *name_0, <span class="keywordtype">char</span> *name_1, <a class="code" href="split__tcp__gateway_8h.html#aa268a41a13430b18e933ed40207178d0">DIRECTION</a> _mode, <a class="code" href="structForward.html">Forward</a> *_forward, <a class="code" href="structForward.html">Forward</a> *_forward_back) : dev_this(dev_0), dev_another(dev_1), name_this(name_0), name_another(name_1), mode(_mode), forward(_forward), forward_back(_forward_back){}
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 };
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 <span class="comment">/*u_char console_y;</span>
<a name="l00819"></a>00819 <span class="comment"></span>
<a name="l00820"></a>00820 <span class="comment">u_char getCursorX(void)</span>
<a name="l00821"></a>00821 <span class="comment">{</span>
<a name="l00822"></a>00822 <span class="comment">CONSOLE_SCREEN_BUFFER_INFO csbInfo;</span>
<a name="l00823"></a>00823 <span class="comment">GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;csbInfo);</span>
<a name="l00824"></a>00824 <span class="comment">return csbInfo.dwCursorPosition.X;</span>
<a name="l00825"></a>00825 <span class="comment">}</span>
<a name="l00826"></a>00826 <span class="comment">u_char getCursorY(void)</span>
<a name="l00827"></a>00827 <span class="comment">{</span>
<a name="l00828"></a>00828 <span class="comment">CONSOLE_SCREEN_BUFFER_INFO csbInfo;</span>
<a name="l00829"></a>00829 <span class="comment">GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;csbInfo);</span>
<a name="l00830"></a>00830 <span class="comment">return csbInfo.dwCursorPosition.Y;</span>
<a name="l00831"></a>00831 <span class="comment">}</span>
<a name="l00832"></a>00832 <span class="comment"></span>
<a name="l00833"></a>00833 <span class="comment">int gotoTextPos(u_char x, u_char y)</span>
<a name="l00834"></a>00834 <span class="comment">{</span>
<a name="l00835"></a>00835 <span class="comment">        COORD cd;</span>
<a name="l00836"></a>00836 <span class="comment">        cd.X = x;</span>
<a name="l00837"></a>00837 <span class="comment">        cd.Y = y;</span>
<a name="l00838"></a>00838 <span class="comment">        return SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), cd);</span>
<a name="l00839"></a>00839 <span class="comment">}</span>
<a name="l00840"></a>00840 <span class="comment">*/</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 20 2012 16:30:04 for Mobile Accelerator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
